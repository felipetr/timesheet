<?phpfunction chamamodulo($local, $link_db, $baseurl, $chamaarray){    $modulourl = '';    $querymod = "SELECT * FROM ft_modulos WHERE posicao = '{$local}' AND ativo = 1 ORDER by ordem" or die("Erro.." . mysqli_error($link_db));    $result = mysqli_query($link_db, $querymod);    while ($modulo = mysqli_fetch_array($result)) {        if ($modulo['mostratitulo'] == 1) {            $modulourl .= '<h4 class="text-center">' . $modulo['nome'] . '</h4>';        }        if ($modulo['tipo'] == 'menu') {            $modulourl .= '<button id="respmenu'.$modulo['id'].'" class="respmenu" onclick="colapsemenu('.$modulo['id'].');"><i class="fa fa-bars" aria-hidden="true"></i></button>';            $modulourl .= '<ul id="menu'.$modulo['id'].'" class="' . $modulo['class_pai'] . '">';            $idmenu = $modulo['id'];            $queryint = "SELECT * FROM ft_menu_itens WHERE menu_id = '{$idmenu}' AND ativo = 1 ORDER by ordem" or die("Erro.." . mysqli_error($link_db));            $queryint = mysqli_query($link_db, $queryint);            while ($menu = mysqli_fetch_array($queryint)) {                $idmenu = $modulo['id'];                if($menu['parent'] == 'none') {                    @$sessionlogado = $_SESSION['ts_logado'];                    if ($menu['link'] == 'interno') {                        $menu['url'] = $baseurl . $menu['url'];                    }                    $mostra = 1;                    $classemostra = '';                    if ($menu['logado'] == 1) {                        $mostra = 0;                    }                    if ($sessionlogado == 1) {                        $mostra = 1;                    }                    if ($mostra == 0) {                        $classemostra = 'displaynone';                    }                        $modulourl .= '<li class="' . $modulo['class_item'] . ' ' . $classemostra . ' logado' . $menu['logado'] . '">';                        $modulourl .= '<a title="' . $menu['titulo'] . '" href="' . $menu['url'] . '" target="' . $menu['target'] . '" onclick="' . $menu['onclick'] . '">';                        $modulourl .= $menu['titulo'];                        $modulourl .= '</a>';                    if ($menu['parent'] != 'none') {                        $queryints = "SELECT * FROM ft_menu_itens WHERE menu_id = '{$idmenu}' AND ativo = 1 ORDER by ordem" or die("Erro.." . mysqli_error($link_db));                        $queryints = mysqli_query($link_db, $queryints);                        $rowcount = mysqli_num_rows($queryints);                        if ($rowcount != 0) {                            $modulourl .= '<ul>';                            while ($submenu = mysqli_fetch_array($queryints)) {                                if ($submenu['link'] == 'interno') {                                    $submenu['url'] = $baseurl . $menu['url'];                                }                                $mostra = 1;                                $classemostra = '';                                if ($submenu['logado'] == 1) {                                    $mostra = 0;                                }                                if ($sessionlogado == 1) {                                    $mostra = 1;                                }                                if ($mostra == 0) {                                    $classemostra = 'displaynone';                                }                                $modulourl .= '<li class="' . $modulo['class_item'] . ' ' . $classemostra . ' logado' . $menu['logado'] . '">';                                $modulourl .= '<a title="' . $menu['titulo'] . '" href="' . $menu['url'] . '" target="' . $menu['target'] . '" onclick="' . $menu['onclick'] . '">';                                $modulourl .= $menu['titulo'];                                $modulourl .= '</a>';                                $modulourl .= '</li>';                            }                            $modulourl .= '</ul>';                        }                        $modulourl .= '</li>';                    }                }            }            $modulourl .= '</ul>';        }        if ($modulo['tipo'] == 'produtos') {            $modulourl .= '<div class="' . $modulo['class_pai'] . '">';            $ordenacao = $modulo['ordenacao'];            $destaque = $modulo['destaque'];            $destaquecall = '';            if ($destaque != 2) {                $destaquecall = 'destaque = ' . $destaque . ' AND ';            }            $limite = '';            if ($modulo['limite'] != 0) {                $limite .= ' LIMIT ' . $modulo['limite'];            }            $categoria = $modulo['categoria'];            $where = '';            $where .= "destaque = '{$destaque}'";            if ($categoria) {                $where = ' AND categoria = ' . $categoria;            }            $queryint = "SELECT * FROM ft_produtos WHERE {$destaquecall} ativo = 1 ORDER by {$ordenacao}{$limite}" or die("Erro.." . mysqli_error($link_db));            $queryint = mysqli_query($link_db, $queryint);            while ($produto = mysqli_fetch_array($queryint)) {                $id_categoria = $produto['categoria'];                $querycat = "SELECT * FROM ft_produtos_categorias WHERE id = '{$id_categoria}'" or die("Erro.." . mysqli_error($link_db));                $resultcat = mysqli_query($link_db, $querycat);                $contador = 0;                while ($categoria = mysqli_fetch_array($resultcat)) {                    $produto_categoria = $categoria;                    $contador++;                }                $nomedacategoria = 'Sem Categoria';                $produtocategorialink = '';                if ($contador > 0)                {                    $nomedacategoria = $produto_categoria['nome'];                    $produtocategorialink = $baseurl.'/produtos/' . $produto_categoria['slug'] . '/1';                }                $imgpatch = $baseurl . '/admin/uploads/'.$produto['foto'];                if (!$produto['foto'])                {                    $imgpatch = $baseurl . '/imagens/nophoto.jpg';                }                $modulourl .= '<div class="' . $modulo['class_item'] . '">';                $modulourl .= '<div class="produtos">';                $modulourl .= '<div id="produtodescricao'.$produto['id'].'" class="displaynone">';                $modulourl .= '<div class="modal-header">';                $modulourl .= '<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>';                $modulourl .= '<h4 class="modal-title">'.$produto['nome'].'</h4>';                $modulourl .= '</div>';                $modulourl .= '<div class="modal-body">';                $modulourl .= $produto['descricao'];                $modulourl .= '</div>';                $modulourl .= '<div class="modal-footer">';                $modulourl .= '<button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>';                $modulourl .= '</div>';                $modulourl .= '</div>';                $modulourl .= '<a href="'.$produtocategorialink.'" style="cursor:pointer;"';                $modulourl .= 'class="categoria">' . $nomedacategoria . '</a>';                $modulourl .= '<div class="prodcont">';                $modulourl .= '<img src="' . $baseurl . '/imagens/inv.png" style="background-image: url(\'' . $imgpatch . '\');">';                $modulourl .= '<div class="prodcont">';                $modulourl .= '<div class="nomeprod">' . $produto['nome'] . '</div>';                $modulourl .= '</div></div>';                $modulourl .= '<div class="info-prod" onclick="abreprod(\'' . $produto['id'] . '\');">Informações</div>';                $modulourl .= '<div class="add-prod" onclick="addproduto(\'' . $produto['id'] . '\',baseurl);">Adicionar';                $modulourl .= '</div></div></div>';            }            $modulourl .= '</div>';        }        if ($modulo['tipo'] == 'banner') {            $modulourl .= '<div class="' . $modulo['class_pai'] . '">';            $categorialist = '';            if ($modulo['categoria']) {                $categorialist = 'categoria = ' . $modulo['categoria'] . ' AND';            }            $queryint = "SELECT * FROM ft_banners WHERE {$categorialist} ativo = 1 ORDER by ordem" or die("Erro.." . mysqli_error($link_db));            $queryint = mysqli_query($link_db, $queryint);            while ($banner = mysqli_fetch_array($queryint)) {                $modulourl .= '<div class="' . $modulo['class_item'] . '">';                if ($banner['link']) {                    $modulourl .= '<a href="' . $banner['link'] . '" target="' . $banner['target'] . '" title="' . $banner['nome'] . '">';                }                $modulourl .= '<img src="' . $baseurl . '/admin/uploads/' . $banner['imagem'] . '" class="btn-block">';                if ($banner['link']) {                    $modulourl .= '</a>';                }                $modulourl .= '</div>';            }            $modulourl .= '</div>';        }        if ($modulo['tipo'] == 'redessociais') {            $modulourl .= '<div class="' . $modulo['class_pai'] . '">';            $queryint = "SELECT * FROM ft_redes_sociais ORDER by ordem" or die("Erro.." . mysqli_error($link_db));            $queryint = mysqli_query($link_db, $queryint);            while ($rede = mysqli_fetch_array($queryint)) {                $redeconfig = $chamaarray[$rede['slug']];                $urlrede = '';                 if($redeconfig['link']=='normal')                 {                     $urlrede = $redeconfig['urlbase'].$rede['url'];                 }                if($redeconfig['link']=='tel')                {                    $urlrede = 'tel:'.$rede['url'];                }                if($redeconfig['link']=='tumblr')                {                    $urlrede = 'http://'.$rede['url'].$redeconfig['urlbase'];                }                if($redeconfig['link'] != 'skype')                {                $modulourl .= '<a target="_blank" title="'.$redeconfig['nome'].'" href="'.$urlrede.'" class="'.$modulo['class_item'].' '.$redeconfig['classe'].' ">';                }else                {                    $modulourl .= '<script type="text/javascript" src="https://secure.skypeassets.com/i/scom/js/skype-uri.js"></script>';                    $modulourl .= '<div id="SkypeButton_Call_usuario_1" class="displaynone">';                    $modulourl .= '<script type="text/javascript">';                    $modulourl .= 'Skype.ui({';                    $modulourl .= '"name": "chat",';                    $modulourl .= '"element": "SkypeButton_Call_usuario_1",';                    $modulourl .= '"participants": ["'.$rede['url'].'"]';                    $modulourl .= '});';                    $modulourl .= '</script>';                    $modulourl .= '</div>';                    $modulourl .= '<a title="'.$redeconfig['nome'].'" onclick="$(\'#SkypeButton_Call_usuario_1_paraElement a\').click();" class="'.$modulo['class_item'].' '.$redeconfig['classe'].' ">';                }                $modulourl .= '<div class="bg"></div><i class="fa fa-'.$redeconfig['icone'].'" aria-hidden="true"></i></a>';            }            $modulourl .= '</div>';        }        if ($modulo['tipo'] == 'conteudohtml') {            $modulourl .= '<div class="' . $modulo['class_pai'] . '">';                $modulourl .= '<div class="' . $modulo['class_item'] . '">';                $modulourl .= $modulo['content'];                $modulourl .= '</div>';            $modulourl .= '</div>';        }        echo $modulourl;    }}function rand_string( $length ) {    $chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";    return substr(str_shuffle($chars),0,$length);}function valida_cnpj ( $cnpj ) {    // Deixa o CNPJ com apenas números    $cnpj = preg_replace( '/[^0-9]/', '', $cnpj );    // Garante que o CNPJ é uma string    $cnpj = (string)$cnpj;    // O valor original    $cnpj_original = $cnpj;    // Captura os primeiros 12 números do CNPJ    $primeiros_numeros_cnpj = substr( $cnpj, 0, 12 );    /**     * Multiplicação do CNPJ     *     * @param string $cnpj Os digitos do CNPJ     * @param int $posicoes A posição que vai iniciar a regressão     * @return int O     *     */    if ( ! function_exists('multiplica_cnpj') ) {        function multiplica_cnpj( $cnpj, $posicao = 5 ) {            // Variável para o cálculo            $calculo = 0;            // Laço para percorrer os item do cnpj            for ( $i = 0; $i < strlen( $cnpj ); $i++ ) {                // Cálculo mais posição do CNPJ * a posição                $calculo = $calculo + ( $cnpj[$i] * $posicao );                // Decrementa a posição a cada volta do laço                $posicao--;                // Se a posição for menor que 2, ela se torna 9                if ( $posicao < 2 ) {                    $posicao = 9;                }            }            // Retorna o cálculo            return $calculo;        }    }    // Faz o primeiro cálculo    $primeiro_calculo = multiplica_cnpj( $primeiros_numeros_cnpj );    // Se o resto da divisão entre o primeiro cálculo e 11 for menor que 2, o primeiro    // Dígito é zero (0), caso contrário é 11 - o resto da divisão entre o cálculo e 11    $primeiro_digito = ( $primeiro_calculo % 11 ) < 2 ? 0 :  11 - ( $primeiro_calculo % 11 );    // Concatena o primeiro dígito nos 12 primeiros números do CNPJ    // Agora temos 13 números aqui    $primeiros_numeros_cnpj .= $primeiro_digito;    // O segundo cálculo é a mesma coisa do primeiro, porém, começa na posição 6    $segundo_calculo = multiplica_cnpj( $primeiros_numeros_cnpj, 6 );    $segundo_digito = ( $segundo_calculo % 11 ) < 2 ? 0 :  11 - ( $segundo_calculo % 11 );    // Concatena o segundo dígito ao CNPJ    $cnpj = $primeiros_numeros_cnpj . $segundo_digito;    // Verifica se o CNPJ gerado é idêntico ao enviado    if ( $cnpj === $cnpj_original ) {        return true;    }}function cropimagem($arquivo, $largura, $altura, $baseurl){    $crop = $baseurl.'/imgcrop.php?f='.$arquivo.'&w='.$largura.'&h='.$altura;    return $crop;}?>